<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mijn Verzameling - Geschiedenis</title>

<style>
body {
  margin: 0;
  font-family: 'Segoe UI', Arial, sans-serif;
  background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
  color: white;
  text-align: center;
}

h1 { margin-top: 30px; }
h2 { margin-bottom: 20px; }

button {
  padding: 14px 26px;
  font-size: 16px;
  border-radius: 14px;
  border: none;
  background: gold;
  cursor: pointer;
  margin: 12px;
}

.unit {
  background: rgba(255,255,255,0.12);
  padding: 14px;
  margin: 12px auto;
  border-radius: 16px;
  max-width: 460px;
}

.common { border-left: 6px solid #bdc3c7; }
.rare { border-left: 6px solid #3498db; }
.epic { border-left: 6px solid #9b59b6; }
.legendary { border-left: 6px solid #ff9f1a; }
.mythic { border-left: 6px solid #ffdd00; }
</style>
</head>

<body>

<h1>ðŸ“œ Historische Verzameling</h1>
<h2>ðŸ’° Gulden: <span id="guldenDisplay">0</span></h2>

<button onclick="openCrate('common')">ðŸ“¦ Open Common Crate (20 gulden)</button>
<button onclick="openCrate('rare')">ðŸ“¦ Open Rare Crate (50 gulden)</button>
<button onclick="openCrate('epic')">ðŸ“¦ Open Epic Crate (100 gulden)</button>

<div id="collection"></div>

<a href="games.html">â¬… Terug naar Games</a>

<script>
// ================== STATE + LOCALSTORAGE ==================

// Haal RNG-gulden (macht) op
let rngGulden = parseInt(localStorage.getItem("rngGulden")) || 0;

// Haal Collection-gulden op
let storedCollection = parseInt(localStorage.getItem("collectionGulden"));

// Gebruik altijd de bestaande gulden, zo niet neem RNG-gulden
let collectionGulden = (storedCollection !== null ? storedCollection : rngGulden);

// Haal units op of start met lege object
let units = JSON.parse(localStorage.getItem("units")) || {};

// ================== ZELDZAAMHEID VOLGORDE ==================
const zeldzaamheidVolgorde = {
  common: 1,
  rare: 2,
  epic: 3,
  legendary: 4,
  mythic: 5
};

// ================== ALLE UNITS ==================
const allUnits = [
  { naam: "Holbewoner", zeldzaamheid: "common" },
  { naam: "Romeinse Soldaat", zeldzaamheid: "common" },
  { naam: "Middeleeuwse Ridder", zeldzaamheid: "rare" },
  { naam: "Vikingkrijger", zeldzaamheid: "rare" },
  { naam: "Franse Soldaat", zeldzaamheid: "rare" },
  { naam: "Julius Caesar", zeldzaamheid: "legendary" },
  { naam: "Napoleon Bonaparte", zeldzaamheid: "legendary" },
  { naam: "Leonardo da Vinci", zeldzaamheid: "legendary" },
  { naam: "Alexander de Grote", zeldzaamheid: "mythic" },
  { naam: "Cleopatra", zeldzaamheid: "mythic" }
];

// ================== CRATE KANSEN ==================
const crateChances = {
  common: { common: 70, rare: 29, epic: 1 },
  rare: { common: 20, rare: 60, epic: 19, legendary: 1 },
  epic: { rare: 30, epic: 60, legendary: 9, mythic: 1 }
};

// ================== HELPER FUNCTIES ==================
function rollRarity(crateType) {
  const roll = Math.random() * 100;
  let totaal = 0;
  const chances = crateChances[crateType];
  for (let rarity in chances) {
    totaal += chances[rarity];
    if (roll <= totaal) return rarity;
  }
  return Object.keys(chances)[0];
}

function openCrate(crateType) {
  const prijs = crateType === 'common' ? 20 : crateType === 'rare' ? 50 : 100;
  if (collectionGulden < prijs) {
    alert("âŒ Niet genoeg gulden!");
    return;
  }

  collectionGulden -= prijs;

  const rarity = rollRarity(crateType);
  const possibleUnits = allUnits.filter(u => u.zeldzaamheid === rarity);
  const unit = possibleUnits[Math.floor(Math.random() * possibleUnits.length)];

  voegUnitToe(unit);
  updateUI();
  save();
}

function voegUnitToe(unit) {
  if (!units[unit.naam]) {
    units[unit.naam] = { aantal: 0, zeldzaamheid: unit.zeldzaamheid };
  }
  units[unit.naam].aantal++;
}

// ================== UI ==================
function updateUI() {
  document.getElementById("guldenDisplay").innerText = collectionGulden;
  const container = document.getElementById("collection");
  container.innerHTML = "";

  Object.entries(units)
    .sort((a,b) => zeldzaamheidVolgorde[b[1].zeldzaamheid] - zeldzaamheidVolgorde[a[1].zeldzaamheid])
    .forEach(([naam,data]) => {
      container.innerHTML += `
        <div class="unit ${data.zeldzaamheid}">
          <b>${naam}</b><br>
          Zeldzaamheid: ${data.zeldzaamheid}<br>
          Aantal: ${data.aantal}
        </div>
      `;
    });
}

// ================== LOCALSTORAGE OPSLAAN ==================
function save() {
  localStorage.setItem("collectionGulden", collectionGulden);
  localStorage.setItem("units", JSON.stringify(units));
  // sync met RNG-gulden zodat beide hetzelfde zijn
  localStorage.setItem("rngGulden", collectionGulden);
}

// ================== INIT ==================
updateUI();
</script>

</body>
</html>
