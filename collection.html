<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<title>Mijn Verzameling - geschiedenis feitjes</title>

<style>
body {
  margin: 0;
  font-family: 'Segoe UI', Arial, sans-serif;
  background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
  color: white;
  text-align: center;
}

h1 { margin-top: 30px; }

button {
  padding: 14px 26px;
  font-size: 16px;
  border-radius: 14px;
  border: none;
  background: gold;
  cursor: pointer;
  margin: 12px;
}

.unit {
  background: rgba(255,255,255,0.12);
  padding: 14px;
  margin: 12px auto;
  border-radius: 16px;
  max-width: 460px;
}

.common { border-left: 6px solid #bdc3c7; }
.rare { border-left: 6px solid #3498db; }
.epic { border-left: 6px solid #9b59b6; }
.legendary { border-left: 6px solid #ff9f1a; }
.mythic { border-left: 6px solid #ffdd00; }

a {
  color: #ffeb3b;
  display: block;
  margin: 30px;
}
</style>
</head>

<body>

<h1>ðŸ“œ Historische Verzameling</h1>
<h2>ðŸ’° Gulden: <span id="guldenDisplay">0</span></h2>

<button onclick="openCrate('common')">ðŸ“¦ Open Common Crate (20 gulden)</button>
<button onclick="openCrate('rare')">ðŸ“¦ Open Rare Crate (50 gulden)</button>
<button onclick="openCrate('epic')">ðŸ“¦ Open Epic Crate (100 gulden)</button>

<div id="collection"></div>

<a href="index.html">â¬… Terug naar menu</a>

<script>
/* =====================
   BASIS OPSLAG
===================== */
let gulden = localStorage.getItem("gulden")
  ? parseInt(localStorage.getItem("gulden"))
  : 0;

let units = JSON.parse(localStorage.getItem("units")) || {};

/* =====================
   ZELDZAAMHEID VOLGORDE
===================== */
const zeldzaamheidVolgorde = {
  common: 1,
  rare: 2,
  epic: 3,
  legendary: 4,
  mythic: 5
};

/* =====================
   ALLE UNITS
===================== */
const allUnits = [
  { naam: "Holbewoner", zeldzaamheid: "common" },
  { naam: "Romeinse Soldaat", zeldzaamheid: "common" },
  { naam: "Middeleeuwse Ridder", zeldzaamheid: "rare" },
  { naam: "Vikingkrijger", zeldzaamheid: "rare" },
  { naam: "Franse Soldaat", zeldzaamheid: "rare" },
  { naam: "Julius Caesar", zeldzaamheid: "legendary" },
  { naam: "Napoleon Bonaparte", zeldzaamheid: "legendary" },
  { naam: "Leonardo da Vinci", zeldzaamheid: "legendary" },
  { naam: "Alexander de Grote", zeldzaamheid: "mythic" },
  { naam: "Cleopatra", zeldzaamheid: "mythic" }
];

/* =====================
   CRATE KANSEN PER ZELDZAAMHEID
   voorbeeld:
   common crate â†’ 70% common, 29% rare, 1% epic
===================== */
const crateChances = {
  common: { common: 70, rare: 29, epic: 1 },
  rare: { common: 20, rare: 60, epic: 19, legendary: 1 },
  epic: { rare: 30, epic: 60, legendary: 9, mythic: 1 }
};

/* =====================
   HELPER: ROL EEN ZELDZAAMHEID
===================== */
function rollRarity(crateType) {
  const roll = Math.random() * 100;
  let totaal = 0;
  const chances = crateChances[crateType];
  for (let rarity in chances) {
    totaal += chances[rarity];
    if (roll <= totaal) return rarity;
  }
  // fallback
  return Object.keys(chances)[0];
}

/* =====================
   KIST OPENEN
===================== */
function openCrate(crateType) {
  let prijs = crateType === 'common' ? 20 : crateType === 'rare' ? 50 : 100;
  if (gulden < prijs) {
    alert("âŒ Niet genoeg gulden!");
    return;
  }

  gulden -= prijs;
  localStorage.setItem("gulden", gulden);

  // kies zeldzaamheid
  const rarity = rollRarity(crateType);

  // filter units die bij die zeldzaamheid horen
  const possibleUnits = allUnits.filter(u => u.zeldzaamheid === rarity);

  // kies random unit
  const unit = possibleUnits[Math.floor(Math.random() * possibleUnits.length)];

  voegUnitToe(unit);
  updateUI();
}

/* =====================
   UNIT TOEVOEGEN
===================== */
function voegUnitToe(unit) {
  if (!units[unit.naam]) {
    units[unit.naam] = {
      aantal: 0,
      zeldzaamheid: unit.zeldzaamheid
    };
  }
  units[unit.naam].aantal++;
  localStorage.setItem("units", JSON.stringify(units));
}

/* =====================
   INTERFACE BIJWERKEN
===================== */
function updateUI() {
  document.getElementById("guldenDisplay").innerText = gulden;
  const container = document.getElementById("collection");
  container.innerHTML = "";

  Object.entries(units)
    .sort((a, b) =>
      zeldzaamheidVolgorde[b[1].zeldzaamheid] - zeldzaamheidVolgorde[a[1].zeldzaamheid]
    )
    .forEach(([naam, data]) => {
      container.innerHTML += `
        <div class="unit ${data.zeldzaamheid}">
          <b>${naam}</b><br>
          Zeldzaamheid: ${data.zeldzaamheid}<br>
          Aantal: ${data.aantal}
        </div>
      `;
    });
}

updateUI();
</script>

</body>
</html>
