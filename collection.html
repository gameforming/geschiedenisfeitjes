<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8">
  <title>Mijn Verzameling â€“ Geschiedenis Collectors</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      background: linear-gradient(135deg, #0f2027, #2c5364);
      color: white;
    }
    .container {
      margin-top: 40px;
      width: 90%;
      max-width: 650px;
      text-align: center;
    }
    h1 { margin-bottom: 10px; font-size: 2em; }
    .gulden { margin-bottom: 20px; font-size: 1.2em; }
    .crates { display: flex; justify-content: space-around; margin-bottom: 30px; gap: 10px; }
    .crate { background: rgba(255,255,255,0.15); padding: 15px; border-radius: 15px; cursor: pointer; transition: transform 0.15s; width: 30%; }
    .crate:hover { transform: translateY(-3px); }
    .units { display: flex; flex-direction: column; gap: 10px; }
    .unit { background: rgba(255,255,255,0.12); border-radius: 15px; padding: 12px; display: flex; justify-content: space-between; }
    .back { display: block; margin-top: 30px; text-decoration: none; color: white; opacity: 0.9; }
  </style>
</head>
<body>

<div class="container">
  <h1>ðŸ“¦ Mijn Verzameling</h1>
  <div class="gulden">ðŸ’° Gulden: <span id="guldenDisplay">0</span></div>

  <div class="crates">
    <div class="crate" onclick="buyCrate('houten')">ðŸŸ¤ Houten crate<br>100 Gulden</div>
    <div class="crate" onclick="buyCrate('zilveren')">ðŸŸ¦ Zilveren crate<br>300 Gulden</div>
    <div class="crate" onclick="buyCrate('gouden')">ðŸŸ¨ Gouden crate<br>700 Gulden</div>
  </div>

  <div class="units" id="unitContainer"></div>
  <a class="back" href="index.html">â¬… Terug naar home</a>
</div>

<script>
// ===== BASIS DATA =====
let gulden = localStorage.getItem('gulden') ? parseInt(localStorage.getItem('gulden')) : 0;
document.getElementById('guldenDisplay').innerText = gulden;

// Units stacken per naam
let units = JSON.parse(localStorage.getItem('units')) || {};

// Zeldzaamheids-volgorde (voor sorteren)
const rarityOrder = ['Legendary', 'Epic', 'Rare', 'Common'];

// Units database (HEEL MAKKELIJK UIT TE BREIDEN)
const unitList = [
  { name: 'Roman Soldier', rarity: 'Common', chance: 40 },
  { name: 'Greek Hoplite', rarity: 'Common', chance: 30 },
  { name: 'Roman Centurion', rarity: 'Rare', chance: 15 },
  { name: 'Spartan Warrior', rarity: 'Epic', chance: 10 },
  { name: 'greek philosopher', rarity: 'Legendary', chance: 5 }
];

// Crates (kies welke units erin kunnen zitten)
const crates = {
  houten: { price: 100, pool: ['Common'] },
  zilveren: { price: 300, pool: ['Common','Rare','Rare'] },
  gouden: { price: 700, pool: ['Rare','Epic','Epic','Legendary'] }
};

// ===== FUNCTIES =====
function buyCrate(type){
  const crate = crates[type];
  if(gulden < crate.price){
    alert('âŒ Niet genoeg gulden');
    return;
  }

  gulden -= crate.price;
  localStorage.setItem('gulden', gulden);
  document.getElementById('guldenDisplay').innerText = gulden;

  // Kies rarity uit crate
  const rarity = crate.pool[Math.floor(Math.random()*crate.pool.length)];
  const candidates = unitList.filter(u => u.rarity === rarity);

  // Kansberekening (percentage)
  const roll = Math.random() * 100;
  let total = 0;
  let unit = candidates[0];
  for(const u of candidates){
    total += u.chance;
    if(roll <= total){ unit = u; break; }
  }

  // Stacken
  if(!units[unit.name]){
    units[unit.name] = { count: 0, rarity: unit.rarity, chance: unit.chance };
  }
  units[unit.name].count++;

  localStorage.setItem('units', JSON.stringify(units));
  renderUnits();

  alert(`ðŸŽ‰ Je kreeg: ${unit.name} (${unit.rarity})`);
}

function renderUnits(){
  const container = document.getElementById('unitContainer');
  container.innerHTML = '';

  const sorted = Object.entries(units).sort((a,b) =>
    rarityOrder.indexOf(a[1].rarity) - rarityOrder.indexOf(b[1].rarity)
  );

  for(const [name,data] of sorted){
    const div = document.createElement('div');
    div.className = 'unit';
    div.innerHTML = `<strong>${name}</strong> ${data.rarity} ${data.chance}% Ã—${data.count}`;
    container.appendChild(div);
  }
}

renderUnits();
</script>

</body>
</html>
